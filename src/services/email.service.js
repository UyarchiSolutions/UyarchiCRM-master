const nodemailer = require('nodemailer');
const config = require('../config/config');
const logger = require('../config/logger');
let ejs = require('ejs');
const transport = nodemailer.createTransport(config.email.smtp);
/* istanbul ignore next */
if (config.env !== 'test') {
  transport
    .verify()
    .then(() => logger.info('Connected to email server'))
    .catch(() => logger.warn('Unable to connect to email server. Make sure you have configured the SMTP options in .env'));
}

const generateOTP = () => {
  digits = '0123456789';
  let OTP = '';
  for (let i = 0; i < 4; i++) {
    OTP += digits[Math.floor(Math.random() * 10)];
  }
  return OTP;
};

// const sendEmail = async (to, subject, text) => {
//   const msg = { from: config.email.from, to, subject, text };
//   await transport.sendMail(msg);
// };

const sendEmail = async (to, mobile, subject, text) => {
  subject = 'Verification Mail';
  let otp = generateOTP();
  let link = `https://realestate.lotsmart.in/#/verify-mail?mobile=${mobile}`;
  // text = `Thank you For Register With Uyarchi, Click the Link To Verify Your Email : ${link}`;

  let msg = {
    from: config.email.from,
    to,
    subject,
    html: `<!DOCTYPE html>
  <html lang="en">
  
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Email Template</title>
  </head>
  
  <style>
      .container {
          max-width: 600px;
          max-height: 800px;
          margin: auto;
      }
  
      .images {
          width: 100%;
          height: 100%;
          position: relative;
      }
  
      img {
          width: 100%;
          height: 100%;
      }
  
      .logo {
          position: absolute;
          top: 5%;
          left: 4%;
      }
  
      .reg-content {
          width: 100%;
          margin: auto !important;
          position: absolute;
          top: 20%;
      }
  
      .reg-content p {
          text-align: center;
          font-size: 34px;
          font-weight: bold;
          color: white;
  
      }
  
      .reg-content-2 {
          width: 100%;
          margin: auto !important;
          position: absolute;
          top: 50%;
      }
  
      .reg-content-2 p {
          width: 80%;
          margin: auto;
          text-align: center;
          font-size: 20px;
          font-weight: bold;
          color: white;
      }
  
      .verify-btn {
          width: 100%;
          display: flex;
          justify-content: center;
          position: absolute;
          top: 65%;
      }
  
      .verify-btn button {
          width: 150px;
          background-color: rgba(255, 255, 255, 1);
          height: 40px;
          color: rgba(57, 72, 103, 1);
          border: none;
          font-size: 18px;
          font-weight: 600;
      }
  
      .footer {
          width: 100%;
          position: absolute;
          height: 55px;
          display: flex;
          top: 86%;
          background-color: rgba(57, 72, 103, 1);
      }
  
      .footer .icons {
          width: 50%;
          height: 100%;
          margin: auto;
          display: flex;
          justify-content: space-between;
      }
  </style>
  
  <body>
      <div class="container">
          <div class="images">
              <img src="https://agora-livestreaming.s3.ap-south-1.amazonaws.com/email+template+image.png" alt="template">
              <div class="logo">
                  <svg width="151" height="52" viewBox="0 0 151 52" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M42.7716 22.0081C38.7327 15.9498 31.8174 11.9623 23.7784 11.9623C16.9513 11.9623 10.9347 14.8381 6.80204 19.4158C6.10517 20.1877 5.46187 21.008 4.87728 21.871L3.75659 22.8845C3.45002 23.1587 3.0393 23.3106 2.61289 23.3074C2.18649 23.3041 0.778525 23.146 0.476861 22.8672C0.175197 22.5883 0.00397292 22.2109 6.79408e-05 21.8164C-0.00383704 21.4218 0.159889 21.0417 0.455983 20.7577L10.2536 10.6172V2.61981C10.2536 2.38898 10.3536 2.1676 10.5316 2.00438C10.7095 1.84115 10.9509 1.74946 11.2027 1.74946H13.9604C14.2121 1.74946 14.4535 1.84115 14.6315 2.00438C14.8095 2.1676 14.9095 2.38898 14.9095 2.61981V6.30905L20.2988 1.32225C20.7519 0.903043 21.2897 0.570512 21.8816 0.343641C22.4736 0.116769 23.108 0 23.7487 0C24.3894 0 25.0238 0.116769 25.6157 0.343641C26.2076 0.570512 26.7455 0.903043 27.1985 1.32225L47.0392 20.7577C47.199 20.8955 47.3271 21.0616 47.416 21.2462C47.5049 21.4308 47.5527 21.6301 47.5565 21.8321C47.5604 22.0341 47.5202 22.2348 47.4384 22.4222C47.3566 22.6096 47.2349 22.7798 47.0805 22.9227C46.926 23.0656 46.7421 23.1782 46.5396 23.2539C46.3371 23.3296 45.1202 23.3668 44.9018 23.3632C44.6835 23.3596 44.4681 23.3154 44.2686 23.2332C44.0692 23.1509 43.8896 23.0323 43.7407 22.8845L42.7716 22.0081ZM23.7792 52C33.8433 52 42.0019 43.8904 42.0019 33.8868C42.0019 23.8831 33.8433 15.7736 23.7792 15.7736C13.715 15.7736 5.55646 23.8831 5.55646 33.8868C5.55646 43.8904 13.715 52 23.7792 52ZM27.8344 44.9523C32.3789 43.3064 35.6239 38.9733 35.6239 33.8868C35.6239 27.3844 30.3209 22.1132 23.7792 22.1132C17.2375 22.1132 11.9344 27.3844 11.9344 33.8868C11.9344 38.7679 14.9227 42.9553 19.18 44.7399V36.4917C19.18 36.1395 19.332 35.8018 19.6025 35.5528C19.873 35.3038 20.2399 35.1639 20.6224 35.1639H26.392C26.7746 35.1639 27.1414 35.3038 27.4119 35.5528C27.6824 35.8018 27.8344 36.1395 27.8344 36.4917V44.9523ZM77.2364 42.3514C77.2364 43.5401 77.0086 44.6651 76.5531 45.7264C76.0975 46.7736 75.4711 47.6863 74.6739 48.4646C73.8909 49.2429 72.9655 49.8585 71.8977 50.3113C70.8442 50.7641 69.7124 50.9906 68.5023 50.9906C67.4204 50.9906 66.3811 50.8066 65.3845 50.4387C64.388 50.0566 63.484 49.5047 62.6725 48.783C61.8752 49.5047 60.9783 50.0566 59.9818 50.4387C58.9995 50.8066 57.9602 50.9906 56.864 50.9906C55.6539 50.9906 54.5221 50.7641 53.4686 50.3113C52.4151 49.8585 51.4897 49.2429 50.6925 48.4646C49.9095 47.6863 49.2902 46.7736 48.8346 45.7264C48.3791 44.6651 48.1513 43.5401 48.1513 42.3514V27.875H53.9811V42.3514C53.9811 42.7476 54.0523 43.1226 54.1947 43.4764C54.3513 43.816 54.5577 44.1203 54.8139 44.3891C55.0844 44.6439 55.3905 44.849 55.7322 45.0047C56.0881 45.1462 56.4654 45.217 56.864 45.217C57.2626 45.217 57.6399 45.1462 57.9958 45.0047C58.3517 44.849 58.6649 44.6439 58.9354 44.3891C59.2059 44.1203 59.4123 43.816 59.5547 43.4764C59.7113 43.1226 59.7896 42.7476 59.7896 42.3514V27.875H65.5981V42.3514C65.5981 42.7476 65.6764 43.1226 65.833 43.4764C65.9896 43.816 66.196 44.1203 66.4523 44.3891C66.7228 44.6439 67.0289 44.849 67.3705 45.0047C67.7264 45.1462 68.1037 45.217 68.5023 45.217C68.901 45.217 69.2782 45.1462 69.6341 45.0047C69.9901 44.849 70.2961 44.6439 70.5524 44.3891C70.8229 44.1203 71.0364 43.816 71.193 43.4764C71.3496 43.1226 71.4279 42.7476 71.4279 42.3514V27.875H77.2364V42.3514ZM83.6514 50.566H89.4812V37.5755C89.4812 36.9811 89.5951 36.4222 89.8229 35.8986C90.0507 35.3608 90.3639 34.8939 90.7625 34.4976C91.1611 34.1014 91.631 33.7901 92.1719 33.5637C92.7129 33.3373 93.2895 33.2241 93.9017 33.2241C94.4996 33.2241 95.0619 33.3373 95.5887 33.5637C96.1154 33.7901 96.5781 34.1014 96.9767 34.4976C97.3754 34.8939 97.6886 35.3608 97.9164 35.8986C98.1441 36.4222 98.258 36.9811 98.258 37.5755V50.566H104.088V37.5755C104.088 36.1745 103.817 34.8585 103.276 33.6273C102.75 32.3821 102.024 31.2995 101.098 30.3797C100.173 29.4457 99.0909 28.717 97.8523 28.1934C96.6137 27.6557 95.2969 27.3868 93.9017 27.3868C92.6061 27.3868 91.3605 27.6203 90.1646 28.0873C88.983 28.5401 87.9223 29.191 86.9827 30.0401L85.0608 27.8325H83.6514V50.566ZM119.536 45.0047C119.764 45.0755 119.991 45.125 120.219 45.1533C120.447 45.1674 120.675 45.1745 120.903 45.1745C121.472 45.1745 122.02 45.0967 122.547 44.941C123.074 44.7854 123.565 44.566 124.02 44.283C124.49 43.9858 124.903 43.6321 125.259 43.2217C125.629 42.7972 125.928 42.3302 126.156 41.8207L130.427 46.0873C129.886 46.8514 129.259 47.5377 128.548 48.1462C127.85 48.7547 127.088 49.2712 126.263 49.6957C125.451 50.1203 124.59 50.4387 123.679 50.6509C122.782 50.8773 121.856 50.9906 120.903 50.9906C119.294 50.9906 117.778 50.6934 116.354 50.099C114.945 49.5047 113.706 48.6769 112.638 47.6156C111.585 46.5542 110.752 45.2948 110.14 43.8373C109.528 42.3656 109.222 40.7523 109.222 38.9976C109.222 37.2005 109.528 35.559 110.14 34.0731C110.752 32.5873 111.585 31.3207 112.638 30.2736C113.706 29.2264 114.945 28.4127 116.354 27.8325C117.778 27.2524 119.294 26.9623 120.903 26.9623C121.856 26.9623 122.789 27.0755 123.7 27.3019C124.611 27.5283 125.473 27.8538 126.284 28.2783C127.11 28.7028 127.878 29.2264 128.59 29.8491C129.302 30.4575 129.929 31.1439 130.47 31.908L119.536 45.0047ZM122.526 33.0542C122.255 32.9552 121.985 32.8915 121.714 32.8632C121.458 32.8349 121.187 32.8207 120.903 32.8207C120.105 32.8207 119.351 32.9693 118.639 33.2665C117.941 33.5495 117.329 33.9599 116.802 34.4976C116.29 35.0354 115.884 35.6863 115.585 36.4505C115.286 37.2005 115.137 38.0495 115.137 38.9976C115.137 39.2099 115.144 39.4505 115.158 39.7193C115.187 39.9882 115.222 40.2641 115.265 40.5472C115.322 40.816 115.386 41.0778 115.457 41.3325C115.528 41.5873 115.621 41.8137 115.735 42.0118L122.526 33.0542ZM135.603 50.566H141.433V38.0424C141.433 37.434 141.547 36.8608 141.775 36.3231C142.003 35.7854 142.316 35.3184 142.714 34.9222C143.113 34.5259 143.583 34.2146 144.124 33.9882C144.665 33.7618 145.241 33.6486 145.853 33.6486H151V27.875H145.853C144.572 27.875 143.334 28.1085 142.138 28.5755C140.942 29.0283 139.874 29.6792 138.935 30.5283L137.013 27.8325H135.603V50.566ZM26.25 41C26.5261 41 26.75 40.7761 26.75 40.5C26.75 40.2239 26.5261 40 26.25 40C25.9739 40 25.75 40.2239 25.75 40.5C25.75 40.7761 25.9739 41 26.25 41ZM21.5 5.01953C21.5 4.74339 21.7239 4.51953 22 4.51953H23C23.2761 4.51953 23.5 4.74339 23.5 5.01953V6.01953C23.5 6.29567 23.2761 6.51953 23 6.51953H22C21.7239 6.51953 21.5 6.29567 21.5 6.01953V5.01953ZM22 7.01953C21.7239 7.01953 21.5 7.24339 21.5 7.51953V8.51953C21.5 8.79567 21.7239 9.01953 22 9.01953H23C23.2761 9.01953 23.5 8.79567 23.5 8.51953V7.51953C23.5 7.24339 23.2761 7.01953 23 7.01953H22ZM24 5.01953C24 4.74339 24.2239 4.51953 24.5 4.51953H25.5C25.7761 4.51953 26 4.74339 26 5.01953V6.01953C26 6.29567 25.7761 6.51953 25.5 6.51953H24.5C24.2239 6.51953 24 6.29567 24 6.01953V5.01953ZM24.5 7.01953C24.2239 7.01953 24 7.24339 24 7.51953V8.51953C24 8.79567 24.2239 9.01953 24.5 9.01953H25.5C25.7761 9.01953 26 8.79567 26 8.51953V7.51953C26 7.24339 25.7761 7.01953 25.5 7.01953H24.5Z"
                          fill="white" />
                  </svg>
              </div>
              <div class="reg-content">
                  <p> “ Verify Your Email To Finish Signing Up In Owner ”</p>
  
              </div>
              <div class="reg-content-2">
                  <p>Please Confirm That ${to} Is Your Email ID By Clicking This Button</p>
              </div>
              <div class="verify-btn">
                  <a href="${link}">
                      <button href="www.google.com">Verify</button>
                  </a>
              </div>
              <div class="footer">
                  <div class="icons">
                      <p>
                          <svg width="20" height="20" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                  d="M15 10.5C12.5139 10.5 10.5 12.5147 10.5 15C10.5 17.486 12.5147 19.5 15 19.5C17.486 19.5 19.5 17.4853 19.5 15C19.5 12.514 17.4854 10.5 15 10.5ZM15 7.5C19.1406 7.5 22.5 10.8556 22.5 15C22.5 19.1408 19.1444 22.5 15 22.5C10.8593 22.5 7.5 19.1444 7.5 15C7.5 10.8593 10.8557 7.5 15 7.5ZM24.75 7.12372C24.75 8.15889 23.9088 8.99875 22.875 8.99875C21.8399 8.99875 21 8.1576 21 7.12372C21 6.08985 21.8411 5.25 22.875 5.25C23.9075 5.24869 24.75 6.08985 24.75 7.12372ZM15 3C11.2883 3 10.6833 3.00982 8.95693 3.0867C7.78076 3.14191 6.99233 3.3001 6.25977 3.5845C5.60877 3.83698 5.13917 4.13847 4.63881 4.63882C4.13654 5.1411 3.83559 5.60945 3.58413 6.26075C3.29907 6.99498 3.14093 7.78217 3.0867 8.95673C3.00908 10.6128 3 11.1916 3 15C3 18.7118 3.00983 19.3167 3.08669 21.0429C3.14193 22.2186 3.30033 23.0082 3.58404 23.739C3.83718 24.3909 4.13928 24.8616 4.63722 25.3596C5.14148 25.8632 5.61122 26.1651 6.25634 26.4141C6.99782 26.7008 7.78575 26.8591 8.95671 26.9133C10.6128 26.9909 11.1916 27 15 27C18.7118 27 19.3167 26.9901 21.0429 26.9133C22.2161 26.8582 23.0063 26.6994 23.739 26.4159C24.3891 26.1634 24.8613 25.8603 25.3596 25.3628C25.8639 24.8577 26.1653 24.3891 26.4146 23.7425C26.7005 23.0037 26.8592 22.2147 26.9133 21.0434C26.9909 19.3872 27 18.8083 27 15C27 11.2883 26.9901 10.6833 26.9133 8.95706C26.8581 7.78359 26.6993 6.99224 26.4155 6.25977C26.1636 5.61057 25.8611 5.13952 25.3611 4.63882C24.858 4.13572 24.3909 3.8354 23.7392 3.58413C23.0055 3.29931 22.2171 3.14094 21.0432 3.08671C19.3872 3.00907 18.8084 3 15 3ZM15 0C19.0749 0 19.5837 0.0149999 21.1838 0.0899999C22.7799 0.163755 23.8688 0.41625 24.825 0.7875C25.8137 1.16876 26.6487 1.68375 27.4824 2.51749C28.3149 3.35125 28.83 4.18875 29.2125 5.175C29.5824 6.13 29.835 7.22 29.91 8.81625C29.9813 10.4163 30 10.925 30 15C30 19.0751 29.985 19.5837 29.91 21.1838C29.8362 22.78 29.5824 23.8687 29.2125 24.825C28.8312 25.8138 28.3149 26.6487 27.4824 27.4825C26.6487 28.315 25.8099 28.83 24.825 29.2125C23.8688 29.5826 22.7799 29.835 21.1838 29.91C19.5837 29.9813 19.0749 30 15 30C10.925 30 10.4162 29.985 8.81625 29.91C7.22 29.8362 6.1325 29.5826 5.175 29.2125C4.18749 28.8312 3.35124 28.315 2.5175 27.4825C1.68375 26.6487 1.17 25.81 0.7875 24.825C0.41625 23.8687 0.165 22.78 0.0900003 21.1838C0.0187503 19.5837 0 19.0751 0 15C0 10.925 0.0150003 10.4163 0.0900003 8.81625C0.16374 7.21875 0.41625 6.13125 0.7875 5.175C1.16874 4.1875 1.68375 3.35125 2.5175 2.51749C3.35124 1.68375 4.18875 1.17 5.175 0.7875C6.13125 0.41625 7.21875 0.165 8.81625 0.0899999C10.4162 0.0187499 10.925 0 15 0Z"
                                  fill="white" />
                          </svg>
                      </p>
                      <p>
                          <svg width="20" height="20" viewBox="0 0 32 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                  d="M6.66642 3.33468C6.66581 4.6918 5.84246 5.91304 4.58463 6.42253C3.32679 6.93204 1.88564 6.62805 0.940737 5.65393C-0.00416656 4.6798 -0.26412 3.23005 0.283436 1.98831C0.83101 0.746574 2.07675 -0.0392048 3.43325 0.00150985C5.23494 0.0555905 6.66724 1.53217 6.66642 3.33468ZM6.76642 9.1344H0.100078V30H6.76642V9.1344ZM17.2993 9.1344H10.6662V30H17.2326V19.0505C17.2326 12.9508 25.1822 12.3842 25.1822 19.0505V30H31.7652V16.784C31.7652 6.50119 19.9991 6.88451 17.2326 11.9342L17.2993 9.1344Z"
                                  fill="white" />
                          </svg>
  
                      </p>
                      <p>
                          <svg width="20" height="20" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                  d="M18.3333 26.6667H26.6667V3.33333H3.33333V26.6667H15V18.3333H11.6667V15H15V12.243C15 10.0143 15.232 9.20603 15.6678 8.39122C16.1037 7.5764 16.743 6.93693 17.5578 6.50117C18.1957 6.16007 18.987 5.9542 20.3695 5.8659C20.9183 5.83085 21.6285 5.87555 22.5 6V9.16667H21.6667C20.1378 9.16667 19.507 9.23887 19.1298 9.44055C18.896 9.56565 18.7323 9.7293 18.6072 9.96322C18.4055 10.3403 18.3333 10.7142 18.3333 12.243V15H22.5L21.6667 18.3333H18.3333V26.6667ZM1.66667 0H28.3333C29.2538 0 30 0.7462 30 1.66667V28.3333C30 29.2538 29.2538 30 28.3333 30H1.66667C0.7462 30 0 29.2538 0 28.3333V1.66667C0 0.7462 0.7462 0 1.66667 0Z"
                                  fill="white" />
                          </svg>
  
                      </p>
                      <p>
                          <svg width="23" height="20" viewBox="0 0 33 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                  d="M10.5 0H0L12.3913 16.5217L0.674925 29.9999H4.64997L14.2325 18.9765L22.5 30H33L20.0875 12.7834L31.2001 0H27.2252L18.2465 10.3287L10.5 0ZM24 27L6 3H9L27 27H24Z"
                                  fill="white" />
                          </svg>
  
                      </p>
                  </div>
              </div>
          </div>
  
      </div>
  
  </body>
  
  </html>`,
  };
  await transport.sendMail(msg);
  return msg;
};

const sendEmailMobile = async (to, mobile, subject, text) => {
  subject = 'Verification Mail';
  let otp = generateOTP();
  let link = `https://mrealestate.lotsmart.in/#/verify-mail?mobile=${mobile}`;
  // text = `Thank you For Register With Uyarchi, Click the Link To Verify Your Email : ${link}`;

  let msg = {
    from: config.email.from,
    to,
    subject,
    html: `<!DOCTYPE html>
    <html lang="en">
    
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Email Template</title>
    </head>
    
    <style>
        .container {
            max-width: 600px;
            max-height: 800px;
            margin: auto;
        }
    
        .images {
            width: 100%;
            height: 100%;
            position: relative;
        }
    
        img {
            width: 100%;
            height: 100%;
        }
    
        .logo {
            position: absolute;
            top: 5%;
            left: 4%;
        }
    
        .reg-content {
            width: 100%;
            margin: auto !important;
            position: absolute;
            top: 20%;
        }
    
        .reg-content p {
            text-align: center;
            font-size: 34px;
            font-weight: bold;
            color: white;
    
        }
    
        .reg-content-2 {
            width: 100%;
            margin: auto !important;
            position: absolute;
            top: 50%;
        }
    
        .reg-content-2 p {
            width: 80%;
            margin: auto;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }
    
        .verify-btn {
            width: 100%;
            display: flex;
            justify-content: center;
            position: absolute;
            top: 65%;
        }
    
        .verify-btn button {
            width: 150px;
            background-color: rgba(255, 255, 255, 1);
            height: 40px;
            color: rgba(57, 72, 103, 1);
            border: none;
            font-size: 18px;
            font-weight: 600;
        }
    
        .footer {
            width: 100%;
            position: absolute;
            height: 55px;
            display: flex;
            top: 86%;
            background-color: rgba(57, 72, 103, 1);
        }
    
        .footer .icons {
            width: 50%;
            height: 100%;
            margin: auto;
            display: flex;
            justify-content: space-between;
        }
    </style>
    
    <body>
        <div class="container">
            <div class="images">
                <img src="https://agora-livestreaming.s3.ap-south-1.amazonaws.com/email+template+image.png" alt="template">
                <div class="logo">
                    <svg width="151" height="52" viewBox="0 0 151 52" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M42.7716 22.0081C38.7327 15.9498 31.8174 11.9623 23.7784 11.9623C16.9513 11.9623 10.9347 14.8381 6.80204 19.4158C6.10517 20.1877 5.46187 21.008 4.87728 21.871L3.75659 22.8845C3.45002 23.1587 3.0393 23.3106 2.61289 23.3074C2.18649 23.3041 0.778525 23.146 0.476861 22.8672C0.175197 22.5883 0.00397292 22.2109 6.79408e-05 21.8164C-0.00383704 21.4218 0.159889 21.0417 0.455983 20.7577L10.2536 10.6172V2.61981C10.2536 2.38898 10.3536 2.1676 10.5316 2.00438C10.7095 1.84115 10.9509 1.74946 11.2027 1.74946H13.9604C14.2121 1.74946 14.4535 1.84115 14.6315 2.00438C14.8095 2.1676 14.9095 2.38898 14.9095 2.61981V6.30905L20.2988 1.32225C20.7519 0.903043 21.2897 0.570512 21.8816 0.343641C22.4736 0.116769 23.108 0 23.7487 0C24.3894 0 25.0238 0.116769 25.6157 0.343641C26.2076 0.570512 26.7455 0.903043 27.1985 1.32225L47.0392 20.7577C47.199 20.8955 47.3271 21.0616 47.416 21.2462C47.5049 21.4308 47.5527 21.6301 47.5565 21.8321C47.5604 22.0341 47.5202 22.2348 47.4384 22.4222C47.3566 22.6096 47.2349 22.7798 47.0805 22.9227C46.926 23.0656 46.7421 23.1782 46.5396 23.2539C46.3371 23.3296 45.1202 23.3668 44.9018 23.3632C44.6835 23.3596 44.4681 23.3154 44.2686 23.2332C44.0692 23.1509 43.8896 23.0323 43.7407 22.8845L42.7716 22.0081ZM23.7792 52C33.8433 52 42.0019 43.8904 42.0019 33.8868C42.0019 23.8831 33.8433 15.7736 23.7792 15.7736C13.715 15.7736 5.55646 23.8831 5.55646 33.8868C5.55646 43.8904 13.715 52 23.7792 52ZM27.8344 44.9523C32.3789 43.3064 35.6239 38.9733 35.6239 33.8868C35.6239 27.3844 30.3209 22.1132 23.7792 22.1132C17.2375 22.1132 11.9344 27.3844 11.9344 33.8868C11.9344 38.7679 14.9227 42.9553 19.18 44.7399V36.4917C19.18 36.1395 19.332 35.8018 19.6025 35.5528C19.873 35.3038 20.2399 35.1639 20.6224 35.1639H26.392C26.7746 35.1639 27.1414 35.3038 27.4119 35.5528C27.6824 35.8018 27.8344 36.1395 27.8344 36.4917V44.9523ZM77.2364 42.3514C77.2364 43.5401 77.0086 44.6651 76.5531 45.7264C76.0975 46.7736 75.4711 47.6863 74.6739 48.4646C73.8909 49.2429 72.9655 49.8585 71.8977 50.3113C70.8442 50.7641 69.7124 50.9906 68.5023 50.9906C67.4204 50.9906 66.3811 50.8066 65.3845 50.4387C64.388 50.0566 63.484 49.5047 62.6725 48.783C61.8752 49.5047 60.9783 50.0566 59.9818 50.4387C58.9995 50.8066 57.9602 50.9906 56.864 50.9906C55.6539 50.9906 54.5221 50.7641 53.4686 50.3113C52.4151 49.8585 51.4897 49.2429 50.6925 48.4646C49.9095 47.6863 49.2902 46.7736 48.8346 45.7264C48.3791 44.6651 48.1513 43.5401 48.1513 42.3514V27.875H53.9811V42.3514C53.9811 42.7476 54.0523 43.1226 54.1947 43.4764C54.3513 43.816 54.5577 44.1203 54.8139 44.3891C55.0844 44.6439 55.3905 44.849 55.7322 45.0047C56.0881 45.1462 56.4654 45.217 56.864 45.217C57.2626 45.217 57.6399 45.1462 57.9958 45.0047C58.3517 44.849 58.6649 44.6439 58.9354 44.3891C59.2059 44.1203 59.4123 43.816 59.5547 43.4764C59.7113 43.1226 59.7896 42.7476 59.7896 42.3514V27.875H65.5981V42.3514C65.5981 42.7476 65.6764 43.1226 65.833 43.4764C65.9896 43.816 66.196 44.1203 66.4523 44.3891C66.7228 44.6439 67.0289 44.849 67.3705 45.0047C67.7264 45.1462 68.1037 45.217 68.5023 45.217C68.901 45.217 69.2782 45.1462 69.6341 45.0047C69.9901 44.849 70.2961 44.6439 70.5524 44.3891C70.8229 44.1203 71.0364 43.816 71.193 43.4764C71.3496 43.1226 71.4279 42.7476 71.4279 42.3514V27.875H77.2364V42.3514ZM83.6514 50.566H89.4812V37.5755C89.4812 36.9811 89.5951 36.4222 89.8229 35.8986C90.0507 35.3608 90.3639 34.8939 90.7625 34.4976C91.1611 34.1014 91.631 33.7901 92.1719 33.5637C92.7129 33.3373 93.2895 33.2241 93.9017 33.2241C94.4996 33.2241 95.0619 33.3373 95.5887 33.5637C96.1154 33.7901 96.5781 34.1014 96.9767 34.4976C97.3754 34.8939 97.6886 35.3608 97.9164 35.8986C98.1441 36.4222 98.258 36.9811 98.258 37.5755V50.566H104.088V37.5755C104.088 36.1745 103.817 34.8585 103.276 33.6273C102.75 32.3821 102.024 31.2995 101.098 30.3797C100.173 29.4457 99.0909 28.717 97.8523 28.1934C96.6137 27.6557 95.2969 27.3868 93.9017 27.3868C92.6061 27.3868 91.3605 27.6203 90.1646 28.0873C88.983 28.5401 87.9223 29.191 86.9827 30.0401L85.0608 27.8325H83.6514V50.566ZM119.536 45.0047C119.764 45.0755 119.991 45.125 120.219 45.1533C120.447 45.1674 120.675 45.1745 120.903 45.1745C121.472 45.1745 122.02 45.0967 122.547 44.941C123.074 44.7854 123.565 44.566 124.02 44.283C124.49 43.9858 124.903 43.6321 125.259 43.2217C125.629 42.7972 125.928 42.3302 126.156 41.8207L130.427 46.0873C129.886 46.8514 129.259 47.5377 128.548 48.1462C127.85 48.7547 127.088 49.2712 126.263 49.6957C125.451 50.1203 124.59 50.4387 123.679 50.6509C122.782 50.8773 121.856 50.9906 120.903 50.9906C119.294 50.9906 117.778 50.6934 116.354 50.099C114.945 49.5047 113.706 48.6769 112.638 47.6156C111.585 46.5542 110.752 45.2948 110.14 43.8373C109.528 42.3656 109.222 40.7523 109.222 38.9976C109.222 37.2005 109.528 35.559 110.14 34.0731C110.752 32.5873 111.585 31.3207 112.638 30.2736C113.706 29.2264 114.945 28.4127 116.354 27.8325C117.778 27.2524 119.294 26.9623 120.903 26.9623C121.856 26.9623 122.789 27.0755 123.7 27.3019C124.611 27.5283 125.473 27.8538 126.284 28.2783C127.11 28.7028 127.878 29.2264 128.59 29.8491C129.302 30.4575 129.929 31.1439 130.47 31.908L119.536 45.0047ZM122.526 33.0542C122.255 32.9552 121.985 32.8915 121.714 32.8632C121.458 32.8349 121.187 32.8207 120.903 32.8207C120.105 32.8207 119.351 32.9693 118.639 33.2665C117.941 33.5495 117.329 33.9599 116.802 34.4976C116.29 35.0354 115.884 35.6863 115.585 36.4505C115.286 37.2005 115.137 38.0495 115.137 38.9976C115.137 39.2099 115.144 39.4505 115.158 39.7193C115.187 39.9882 115.222 40.2641 115.265 40.5472C115.322 40.816 115.386 41.0778 115.457 41.3325C115.528 41.5873 115.621 41.8137 115.735 42.0118L122.526 33.0542ZM135.603 50.566H141.433V38.0424C141.433 37.434 141.547 36.8608 141.775 36.3231C142.003 35.7854 142.316 35.3184 142.714 34.9222C143.113 34.5259 143.583 34.2146 144.124 33.9882C144.665 33.7618 145.241 33.6486 145.853 33.6486H151V27.875H145.853C144.572 27.875 143.334 28.1085 142.138 28.5755C140.942 29.0283 139.874 29.6792 138.935 30.5283L137.013 27.8325H135.603V50.566ZM26.25 41C26.5261 41 26.75 40.7761 26.75 40.5C26.75 40.2239 26.5261 40 26.25 40C25.9739 40 25.75 40.2239 25.75 40.5C25.75 40.7761 25.9739 41 26.25 41ZM21.5 5.01953C21.5 4.74339 21.7239 4.51953 22 4.51953H23C23.2761 4.51953 23.5 4.74339 23.5 5.01953V6.01953C23.5 6.29567 23.2761 6.51953 23 6.51953H22C21.7239 6.51953 21.5 6.29567 21.5 6.01953V5.01953ZM22 7.01953C21.7239 7.01953 21.5 7.24339 21.5 7.51953V8.51953C21.5 8.79567 21.7239 9.01953 22 9.01953H23C23.2761 9.01953 23.5 8.79567 23.5 8.51953V7.51953C23.5 7.24339 23.2761 7.01953 23 7.01953H22ZM24 5.01953C24 4.74339 24.2239 4.51953 24.5 4.51953H25.5C25.7761 4.51953 26 4.74339 26 5.01953V6.01953C26 6.29567 25.7761 6.51953 25.5 6.51953H24.5C24.2239 6.51953 24 6.29567 24 6.01953V5.01953ZM24.5 7.01953C24.2239 7.01953 24 7.24339 24 7.51953V8.51953C24 8.79567 24.2239 9.01953 24.5 9.01953H25.5C25.7761 9.01953 26 8.79567 26 8.51953V7.51953C26 7.24339 25.7761 7.01953 25.5 7.01953H24.5Z"
                            fill="white" />
                    </svg>
                </div>
                <div class="reg-content">
                    <p> “ Verify Your Email To Finish Signing Up In Owner ”</p>
    
                </div>
                <div class="reg-content-2">
                    <p>Please Confirm That ${to} Is Your Email ID By Clicking This Button</p>
                </div>
                <div class="verify-btn">
                    <a href="${link}">
                        <button href="www.google.com">Verify</button>
                    </a>
                </div>
                <div class="footer">
                    <div class="icons">
                        <p>
                            <svg width="20" height="20" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M15 10.5C12.5139 10.5 10.5 12.5147 10.5 15C10.5 17.486 12.5147 19.5 15 19.5C17.486 19.5 19.5 17.4853 19.5 15C19.5 12.514 17.4854 10.5 15 10.5ZM15 7.5C19.1406 7.5 22.5 10.8556 22.5 15C22.5 19.1408 19.1444 22.5 15 22.5C10.8593 22.5 7.5 19.1444 7.5 15C7.5 10.8593 10.8557 7.5 15 7.5ZM24.75 7.12372C24.75 8.15889 23.9088 8.99875 22.875 8.99875C21.8399 8.99875 21 8.1576 21 7.12372C21 6.08985 21.8411 5.25 22.875 5.25C23.9075 5.24869 24.75 6.08985 24.75 7.12372ZM15 3C11.2883 3 10.6833 3.00982 8.95693 3.0867C7.78076 3.14191 6.99233 3.3001 6.25977 3.5845C5.60877 3.83698 5.13917 4.13847 4.63881 4.63882C4.13654 5.1411 3.83559 5.60945 3.58413 6.26075C3.29907 6.99498 3.14093 7.78217 3.0867 8.95673C3.00908 10.6128 3 11.1916 3 15C3 18.7118 3.00983 19.3167 3.08669 21.0429C3.14193 22.2186 3.30033 23.0082 3.58404 23.739C3.83718 24.3909 4.13928 24.8616 4.63722 25.3596C5.14148 25.8632 5.61122 26.1651 6.25634 26.4141C6.99782 26.7008 7.78575 26.8591 8.95671 26.9133C10.6128 26.9909 11.1916 27 15 27C18.7118 27 19.3167 26.9901 21.0429 26.9133C22.2161 26.8582 23.0063 26.6994 23.739 26.4159C24.3891 26.1634 24.8613 25.8603 25.3596 25.3628C25.8639 24.8577 26.1653 24.3891 26.4146 23.7425C26.7005 23.0037 26.8592 22.2147 26.9133 21.0434C26.9909 19.3872 27 18.8083 27 15C27 11.2883 26.9901 10.6833 26.9133 8.95706C26.8581 7.78359 26.6993 6.99224 26.4155 6.25977C26.1636 5.61057 25.8611 5.13952 25.3611 4.63882C24.858 4.13572 24.3909 3.8354 23.7392 3.58413C23.0055 3.29931 22.2171 3.14094 21.0432 3.08671C19.3872 3.00907 18.8084 3 15 3ZM15 0C19.0749 0 19.5837 0.0149999 21.1838 0.0899999C22.7799 0.163755 23.8688 0.41625 24.825 0.7875C25.8137 1.16876 26.6487 1.68375 27.4824 2.51749C28.3149 3.35125 28.83 4.18875 29.2125 5.175C29.5824 6.13 29.835 7.22 29.91 8.81625C29.9813 10.4163 30 10.925 30 15C30 19.0751 29.985 19.5837 29.91 21.1838C29.8362 22.78 29.5824 23.8687 29.2125 24.825C28.8312 25.8138 28.3149 26.6487 27.4824 27.4825C26.6487 28.315 25.8099 28.83 24.825 29.2125C23.8688 29.5826 22.7799 29.835 21.1838 29.91C19.5837 29.9813 19.0749 30 15 30C10.925 30 10.4162 29.985 8.81625 29.91C7.22 29.8362 6.1325 29.5826 5.175 29.2125C4.18749 28.8312 3.35124 28.315 2.5175 27.4825C1.68375 26.6487 1.17 25.81 0.7875 24.825C0.41625 23.8687 0.165 22.78 0.0900003 21.1838C0.0187503 19.5837 0 19.0751 0 15C0 10.925 0.0150003 10.4163 0.0900003 8.81625C0.16374 7.21875 0.41625 6.13125 0.7875 5.175C1.16874 4.1875 1.68375 3.35125 2.5175 2.51749C3.35124 1.68375 4.18875 1.17 5.175 0.7875C6.13125 0.41625 7.21875 0.165 8.81625 0.0899999C10.4162 0.0187499 10.925 0 15 0Z"
                                    fill="white" />
                            </svg>
                        </p>
                        <p>
                            <svg width="20" height="20" viewBox="0 0 32 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M6.66642 3.33468C6.66581 4.6918 5.84246 5.91304 4.58463 6.42253C3.32679 6.93204 1.88564 6.62805 0.940737 5.65393C-0.00416656 4.6798 -0.26412 3.23005 0.283436 1.98831C0.83101 0.746574 2.07675 -0.0392048 3.43325 0.00150985C5.23494 0.0555905 6.66724 1.53217 6.66642 3.33468ZM6.76642 9.1344H0.100078V30H6.76642V9.1344ZM17.2993 9.1344H10.6662V30H17.2326V19.0505C17.2326 12.9508 25.1822 12.3842 25.1822 19.0505V30H31.7652V16.784C31.7652 6.50119 19.9991 6.88451 17.2326 11.9342L17.2993 9.1344Z"
                                    fill="white" />
                            </svg>
    
                        </p>
                        <p>
                            <svg width="20" height="20" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M18.3333 26.6667H26.6667V3.33333H3.33333V26.6667H15V18.3333H11.6667V15H15V12.243C15 10.0143 15.232 9.20603 15.6678 8.39122C16.1037 7.5764 16.743 6.93693 17.5578 6.50117C18.1957 6.16007 18.987 5.9542 20.3695 5.8659C20.9183 5.83085 21.6285 5.87555 22.5 6V9.16667H21.6667C20.1378 9.16667 19.507 9.23887 19.1298 9.44055C18.896 9.56565 18.7323 9.7293 18.6072 9.96322C18.4055 10.3403 18.3333 10.7142 18.3333 12.243V15H22.5L21.6667 18.3333H18.3333V26.6667ZM1.66667 0H28.3333C29.2538 0 30 0.7462 30 1.66667V28.3333C30 29.2538 29.2538 30 28.3333 30H1.66667C0.7462 30 0 29.2538 0 28.3333V1.66667C0 0.7462 0.7462 0 1.66667 0Z"
                                    fill="white" />
                            </svg>
    
                        </p>
                        <p>
                            <svg width="23" height="20" viewBox="0 0 33 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M10.5 0H0L12.3913 16.5217L0.674925 29.9999H4.64997L14.2325 18.9765L22.5 30H33L20.0875 12.7834L31.2001 0H27.2252L18.2465 10.3287L10.5 0ZM24 27L6 3H9L27 27H24Z"
                                    fill="white" />
                            </svg>
    
                        </p>
                    </div>
                </div>
            </div>
    
        </div>
    
    </body>
    
    </html>`,
  };
  await transport.sendMail(msg);
  return msg;
};

const sendEmailSeller = async (to, mobile, subject, text) => {
  console.log(mobile);
  subject = "Don't share your otp";
  let otp = generateOTP();
  let link = `https://realestate.lotsmart.in/#/varifi-seller?mobile=${mobile}`;
  text = `Thank you For Register With Uyarchi, Click the Link To Verify Your Email : ${link}`;
  let msg = { from: config.email.from, to, subject, text, otp };
  await transport.sendMail(msg);
  return msg;
};

const sendEmailSellerMobile = async (to, mobile, subject, text) => {
  console.log(mobile);
  subject = "Don't share your otp";
  let otp = generateOTP();
  let link = `https://mrealestate.lotsmart.in/#/varifi-seller?mobile=${mobile}`;
  text = `Thank you For Register With Uyarchi, Click the Link To Verify Your Email : ${link}`;
  let msg = { from: config.email.from, to, subject, text, otp };
  await transport.sendMail(msg);
  return msg;
};

/**
 * Send reset password email
 * @param {string} to
 * @param {string} token
 * @returns {Promise}
 */
const sendResetPasswordEmail = async (to, token) => {
  const subject = 'Reset password';
  // replace this url with the link to the reset password page of your front-end app
  const resetPasswordUrl = `http://link-to-app/reset-password?token=${token}`;
  const text = `Dear user,
To reset your password, click on this link: ${resetPasswordUrl}
If you did not request any password resets, then ignore this email.`;
  await sendEmail(to, subject, text);
};

/**
 * Send verification email
 * @param {string} to
 * @param {string} token
 * @returns {Promise}
 */
const sendVerificationEmail = async (to, token) => {
  const subject = 'Email Verification';
  // replace this url with the link to the email verification page of your front-end app
  const verificationEmailUrl = `http://link-to-app/verify-email?token=${token}`;
  const text = `Dear user,
To verify your email, click on this link: ${verificationEmailUrl}
If you did not create an account, then ignore this email.`;
  await sendEmail(to, subject, text);
};

const sendEmail_Enquiry = async (data) => {
  let { email, Enquiry, date, Answer } = data;
  // const subject = `Reply To Enquiry On:${date}-Register`;
  let datas = await ejs.renderFile(__dirname + '/Enquiry.ejs', data);
  const subject = 'Reply';
  const text = `Enquiry:${Enquiry} Answer:${Answer}`;
  let to = email;
  let msg = { from: config.email.from, to, subject, text, html: datas };
  await transport.sendMail(msg);
};

module.exports = {
  transport,
  sendEmail,
  sendResetPasswordEmail,
  sendVerificationEmail,
  sendEmailSeller,
  sendEmail_Enquiry,
  sendEmailMobile,
  sendEmailSellerMobile,
};
